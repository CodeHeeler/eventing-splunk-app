<form>
  <label>Advisor</label>
  <description>Advisor Dashboard</description>
  <fieldset submitButton="false">
    <input type="time" token="field_timeframe">
      <label>Timeframe</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <table>
        <title>Events</title>
        <search>
          <query>bundle = "rhel" AND  application = "advisor"
| spath 
| rename object.* as *
| convert timeformat="%m-%d-%Y %l:%M %p" ctime(_time) AS created_at_fmt
| spath path=events{} output=events
| stats count by account_id, created_at_fmt, "context.display_name", "context.host_url", "event_type", events 
| eval _raw=events
| kv
| table account_id, created_at_fmt, "context.display_name", "context.host_url", "event_type", "payload.rule_description"
| rename account_id as "Account ID", created_at_fmt as "Time", context.display_name as "Display Name", context.host_url as "Host URL", event_type as "Event Type", "payload.rule_description" as "Rule Description"</query>
          <earliest>$field_timeframe.earliest$</earliest>
          <latest>$field_timeframe.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
      </table>
    </panel>
  </row>
</form>